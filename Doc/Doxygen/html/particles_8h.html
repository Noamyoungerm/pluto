<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/Particles/particles.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.4-patch2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_9206b596ebf640a5bddb105d741e15ea.html">Particles</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">particles.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Particle module header file.  
<a href="#details">More...</a></p>

<p><a href="particles_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a739ac7539d3db0797dec587fb5c311ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a739ac7539d3db0797dec587fb5c311ff">PARTICLES_CR_GC</a>&#160;&#160;&#160;NO</td></tr>
<tr class="separator:a739ac7539d3db0797dec587fb5c311ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dc3734ada35f3a940a8c5526a722df3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a0dc3734ada35f3a940a8c5526a722df3">PARTICLES_CR_C</a>&#160;&#160;&#160;1.0</td></tr>
<tr class="separator:a0dc3734ada35f3a940a8c5526a722df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a001da34d28357b683b4b3b865532cca5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a001da34d28357b683b4b3b865532cca5">PARTICLES_CR_E_MC</a>&#160;&#160;&#160;1.0</td></tr>
<tr class="separator:a001da34d28357b683b4b3b865532cca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc366ac7d2a83e303e6bb4e568421c6a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#afc366ac7d2a83e303e6bb4e568421c6a">PARTICLES_CR_E_MC_GAS</a>&#160;&#160;&#160;1.0</td></tr>
<tr class="separator:afc366ac7d2a83e303e6bb4e568421c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad53695c1daf170150186cf32e2195745"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ad53695c1daf170150186cf32e2195745">PARTICLES_CR_FEEDBACK</a>&#160;&#160;&#160;YES</td></tr>
<tr class="separator:ad53695c1daf170150186cf32e2195745"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d3e750fd8b7670e0ebfc1a79a1b1a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ac2d3e750fd8b7670e0ebfc1a79a1b1a9">PARTICLES_CR_LARMOR_EPS</a>&#160;&#160;&#160;0.3</td></tr>
<tr class="separator:ac2d3e750fd8b7670e0ebfc1a79a1b1a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17512da4846b2ff968b1e7c39fcbe26f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a17512da4846b2ff968b1e7c39fcbe26f">PARTICLES_CR_NCELL_MAX</a>&#160;&#160;&#160;1.8</td></tr>
<tr class="separator:a17512da4846b2ff968b1e7c39fcbe26f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00c02aa2ecf37d7a3cab367a00ecc27"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ab00c02aa2ecf37d7a3cab367a00ecc27">PARTICLES_CR_NSUB</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ab00c02aa2ecf37d7a3cab367a00ecc27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af72e43513336985fecb8307039e1fd15"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#af72e43513336985fecb8307039e1fd15">PARTICLES_CR_PREDICTOR</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:af72e43513336985fecb8307039e1fd15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25926d518ea0b6d6fda0bdd4db47b9c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a25926d518ea0b6d6fda0bdd4db47b9c1">PARTICLES_CR_MAX_FILE_SIZE</a>&#160;&#160;&#160;1.9 /* In GB */</td></tr>
<tr class="separator:a25926d518ea0b6d6fda0bdd4db47b9c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8020885d4756c4ecdfa60386b227c0a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a8020885d4756c4ecdfa60386b227c0a9">PARTICLES_DUST_FEEDBACK</a>&#160;&#160;&#160;YES</td></tr>
<tr class="separator:a8020885d4756c4ecdfa60386b227c0a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9cc285cf19b8dde063c8bbd0c63b346"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ad9cc285cf19b8dde063c8bbd0c63b346">PARTICLES_DUST_TIME_STEPPING</a>&#160;&#160;&#160;EXP_MIDPOINT</td></tr>
<tr class="separator:ad9cc285cf19b8dde063c8bbd0c63b346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bcace04494190e33661aea1fa3a2c47"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a8bcace04494190e33661aea1fa3a2c47">PARTICLES_DUST_STOPPING_TIME</a>&#160;&#160;&#160;CONSTANT</td></tr>
<tr class="separator:a8bcace04494190e33661aea1fa3a2c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f827e1a4f94bcd71138599d6542211"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a82f827e1a4f94bcd71138599d6542211">PARTICLES_DUST_MAX_FILE_SIZE</a>&#160;&#160;&#160;1.9 /* In GB */</td></tr>
<tr class="separator:a82f827e1a4f94bcd71138599d6542211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0f564fadd168f15ee28f0c3e7ec76ba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ae0f564fadd168f15ee28f0c3e7ec76ba">PARTICLES_LP_MAX_FILE_SIZE</a>&#160;&#160;&#160;1.9 /* In GB */</td></tr>
<tr class="separator:ae0f564fadd168f15ee28f0c3e7ec76ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac89499ef2571f49484ba430dacfd8452"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ac89499ef2571f49484ba430dacfd8452">Particles_Boundary</a> (<a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:ac89499ef2571f49484ba430dacfd8452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fae93653fc55623ddf2e0fca5bee8a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a4fae93653fc55623ddf2e0fca5bee8a7">Particles_BoundaryExchange</a> (<a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a4fae93653fc55623ddf2e0fca5bee8a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab85c19b7498aebbc5657df4f756751c6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ab85c19b7498aebbc5657df4f756751c6">Particles_BoundaryCheck</a> (Particle *p, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:ab85c19b7498aebbc5657df4f756751c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e4bca61b635351a74d0fee6934be72"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ad7e4bca61b635351a74d0fee6934be72">Particles_CheckAll</a> (particleNode *, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:ad7e4bca61b635351a74d0fee6934be72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f1a8c2edbf6fe89d2b7f0c62857a3b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a5f1a8c2edbf6fe89d2b7f0c62857a3b7">Particles_CheckSingle</a> (Particle *, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a5f1a8c2edbf6fe89d2b7f0c62857a3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af31f13443a50301901c3317151c0bb71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#af31f13443a50301901c3317151c0bb71">Particles_CR_ComputeCurrent</a> (const <a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:af31f13443a50301901c3317151c0bb71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8b72a010a1c78ede2bcb3f98df05a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a0b8b72a010a1c78ede2bcb3f98df05a1">Particles_CR_ComputeForce</a> (Data_Arr, const <a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a0b8b72a010a1c78ede2bcb3f98df05a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3616941575bf6103f0b2c19ecaef28ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a3616941575bf6103f0b2c19ecaef28ec">Particles_CR_ConservativeFeedback</a> (Data_Arr, Data_Arr, double, <a class="el" href="struct_r_box.html">RBox</a> *)</td></tr>
<tr class="separator:a3616941575bf6103f0b2c19ecaef28ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac627e61f54597c02f931a181eebef606"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ac627e61f54597c02f931a181eebef606">Particles_CR_Flux</a> (const <a class="el" href="struct_state.html">State</a> *, int, int)</td></tr>
<tr class="separator:ac627e61f54597c02f931a181eebef606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9498cb6e93a52f41c61c9fbd44d573a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a9498cb6e93a52f41c61c9fbd44d573a7">Particles_CR_Predictor</a> (<a class="el" href="struct_data.html">Data</a> *, double, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a9498cb6e93a52f41c61c9fbd44d573a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0422db2093f51effd6b41e7e08d92c6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a0422db2093f51effd6b41e7e08d92c6d">Particles_CR_States1DCopy</a> (const <a class="el" href="struct_data.html">Data</a> *, const <a class="el" href="struct_sweep.html">Sweep</a> *, int, int)</td></tr>
<tr class="separator:a0422db2093f51effd6b41e7e08d92c6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5c203aa7f0c6dd105aeb050396dbcfa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ac5c203aa7f0c6dd105aeb050396dbcfa">Particles_CR_StatesSource</a> (const <a class="el" href="struct_sweep.html">Sweep</a> *, double, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:ac5c203aa7f0c6dd105aeb050396dbcfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9a0a975bdb2166dbc069b8bf9141e98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#af9a0a975bdb2166dbc069b8bf9141e98">Particles_CR_Update</a> (<a class="el" href="struct_data.html">Data</a> *, <a class="el" href="structtime_step.html">timeStep</a> *, double, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:af9a0a975bdb2166dbc069b8bf9141e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6508e68e661863384cc3347b3c313281"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a6508e68e661863384cc3347b3c313281">Particles_Density</a> (Particle *, double *)</td></tr>
<tr class="separator:a6508e68e661863384cc3347b3c313281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa41093725769044e70a7802e4ead0494"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#aa41093725769044e70a7802e4ead0494">Particles_Deposit</a> (particleNode *, void(*Func)(Particle *, double *), Data_Arr, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:aa41093725769044e70a7802e4ead0494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8407010c44fc5f3e3f01a5161c7c223c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a8407010c44fc5f3e3f01a5161c7c223c">Particles_DepositBoundaryExchange</a> (Data_Arr, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a8407010c44fc5f3e3f01a5161c7c223c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60df801585965a19256fbf9b1ccc2a7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a60df801585965a19256fbf9b1ccc2a7e">Particles_Destroy</a> (particleNode *, <a class="el" href="struct_data.html">Data</a> *)</td></tr>
<tr class="separator:a60df801585965a19256fbf9b1ccc2a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd06eba30f4c911988352f37b5d667e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a4bd06eba30f4c911988352f37b5d667e">Particles_Display</a> (Particle *)</td></tr>
<tr class="separator:a4bd06eba30f4c911988352f37b5d667e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac884cda951c31b943566ba18698a9d23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ac884cda951c31b943566ba18698a9d23">Particles_Dust_ConservativeFeedback</a> (Data_Arr, Data_Arr, double, <a class="el" href="struct_r_box.html">RBox</a> *)</td></tr>
<tr class="separator:ac884cda951c31b943566ba18698a9d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b39f316bb6a101f319cacc9587bf8cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a6b39f316bb6a101f319cacc9587bf8cd">Particles_Dust_StatesSource</a> (<a class="el" href="struct_sweep.html">Sweep</a> *, Data_Arr, double, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a6b39f316bb6a101f319cacc9587bf8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9612318dfd68b55fd709e8d84f0a5a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#af9612318dfd68b55fd709e8d84f0a5a6">Particles_Dust_Update</a> (<a class="el" href="struct_data.html">Data</a> *, <a class="el" href="structtime_step.html">timeStep</a> *, double, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:af9612318dfd68b55fd709e8d84f0a5a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9f5cb6175c067b45e6ea5b1bf801d5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ab9f5cb6175c067b45e6ea5b1bf801d5c">Particles_GetWeights</a> (Particle *, int *, double ***, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:ab9f5cb6175c067b45e6ea5b1bf801d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53cd749391ba53882f12644323c30ea7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a53cd749391ba53882f12644323c30ea7">Particles_Init</a> (<a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a53cd749391ba53882f12644323c30ea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9595493f6cda3f018df22a61982dcf09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a9595493f6cda3f018df22a61982dcf09">Particles_Inject</a> (<a class="el" href="struct_data.html">Data</a> *d, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a9595493f6cda3f018df22a61982dcf09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a120cd31043219b8e5e5693c65cd36757"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a120cd31043219b8e5e5693c65cd36757">Particles_Insert</a> (Particle *, <a class="el" href="struct_data.html">Data</a> *, char, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a120cd31043219b8e5e5693c65cd36757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8876f5cf3444c952a5db18f2371bf956"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a8876f5cf3444c952a5db18f2371bf956">Particles_Interpolate</a> (double ***, double ***, int *)</td></tr>
<tr class="separator:a8876f5cf3444c952a5db18f2371bf956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff9c08bc507d454ec0e64342040321b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a1ff9c08bc507d454ec0e64342040321b">Particles_InterpolateArr</a> (Data_Arr, int, double ***, int *, double *)</td></tr>
<tr class="separator:a1ff9c08bc507d454ec0e64342040321b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e7790d4543a7119d2f94495fbaaeff2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a4e7790d4543a7119d2f94495fbaaeff2">Particles_ListToArray</a> (<a class="el" href="struct_data.html">Data</a> *d)</td></tr>
<tr class="separator:a4e7790d4543a7119d2f94495fbaaeff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64174d43c048d24f723255145d8f4517"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a64174d43c048d24f723255145d8f4517">Particles_LoadUniform</a> (int, int, double *, double *, double *)</td></tr>
<tr class="separator:a64174d43c048d24f723255145d8f4517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71844c8b2f61e8804b97a968213ff209"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a71844c8b2f61e8804b97a968213ff209">Particles_LocateCell</a> (double *, int *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a71844c8b2f61e8804b97a968213ff209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00567dfdd356f877c2bd47c950aa2bb8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a00567dfdd356f877c2bd47c950aa2bb8">Particles_LP_Update</a> (<a class="el" href="struct_data.html">Data</a> *, <a class="el" href="structtime_step.html">timeStep</a> *, double, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a00567dfdd356f877c2bd47c950aa2bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ab256b348bbcd7bfee071f09fa8db5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ae1ab256b348bbcd7bfee071f09fa8db5">Particles_LP_ComputeShockNormalSpeed</a> (Particle *, double *, double *)</td></tr>
<tr class="separator:ae1ab256b348bbcd7bfee071f09fa8db5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e2795f900e6a4709251b13c3db5ab70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a1e2795f900e6a4709251b13c3db5ab70">Particles_LP_FixValue</a> (Particle *, particleProbe *, <a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a1e2795f900e6a4709251b13c3db5ab70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af10392322e920fb3f1b3eedbba3028b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#af10392322e920fb3f1b3eedbba3028b3">Particles_LP_FlagShock</a> (<a class="el" href="struct_data.html">Data</a> *, char ***, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:af10392322e920fb3f1b3eedbba3028b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83f71d581558bb93438b530309a78994"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a83f71d581558bb93438b530309a78994">Particles_LP_GetEmaxAtShock</a> (Particle *, particleProbe *, double, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a83f71d581558bb93438b530309a78994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8be40ee15cdb6c333fb2947976d398f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#aa8be40ee15cdb6c333fb2947976d398f">Particles_LP_Get_4vel</a> (double *, double *, double *)</td></tr>
<tr class="separator:aa8be40ee15cdb6c333fb2947976d398f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4786855e00681991d540a36d4a3c3cc1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a4786855e00681991d540a36d4a3c3cc1">Particles_LP_Get_3mag</a> (double *, double, double *)</td></tr>
<tr class="separator:a4786855e00681991d540a36d4a3c3cc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c4e72cb89245512be404e78a8e4ee2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a40c4e72cb89245512be404e78a8e4ee2">Particles_LP_IC_Emissivity</a> (Particle *, double, double, double *)</td></tr>
<tr class="separator:a40c4e72cb89245512be404e78a8e4ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25efc6f0b23d587c1711fb9f0176754"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#aa25efc6f0b23d587c1711fb9f0176754">Particles_LP_InitSpectra</a> (Particle *)</td></tr>
<tr class="separator:aa25efc6f0b23d587c1711fb9f0176754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd08c8c1aa8a2f383f7965d44918f6ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#acd08c8c1aa8a2f383f7965d44918f6ce">Particles_LP_IntegrateSpectra</a> (Particle *, double, double *)</td></tr>
<tr class="separator:acd08c8c1aa8a2f383f7965d44918f6ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37dd8f7dd4c6920ff4ea5489cdce65d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a37dd8f7dd4c6920ff4ea5489cdce65d4">Particles_LP_SampleShock</a> (Particle *, particleProbe *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a37dd8f7dd4c6920ff4ea5489cdce65d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56ab9fe6dce1d985e3da384a92b1938c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a56ab9fe6dce1d985e3da384a92b1938c">Particles_LP_UpdateSpectra</a> (<a class="el" href="struct_data.html">Data</a> *, double, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a56ab9fe6dce1d985e3da384a92b1938c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada139d986568a321ff2035e5d1399a0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ada139d986568a321ff2035e5d1399a0d">Particles_LP_Sync_Emissivity</a> (Particle *, double, double, double *, double *, double *)</td></tr>
<tr class="separator:ada139d986568a321ff2035e5d1399a0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac03bc80ed1e86d7d2e044728bd888150"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#ac03bc80ed1e86d7d2e044728bd888150">Particles_Number</a> (particleNode *)</td></tr>
<tr class="separator:ac03bc80ed1e86d7d2e044728bd888150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b1dd72a729b186bf4915be6a3ceae4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#aa1b1dd72a729b186bf4915be6a3ceae4">Particles_Restart</a> (<a class="el" href="struct_data.html">Data</a> *, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:aa1b1dd72a729b186bf4915be6a3ceae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30323e7892f766f3cd64c24c7fbb2e39"><td class="memItemLeft" align="right" valign="top">Particle *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a30323e7892f766f3cd64c24c7fbb2e39">Particles_Select</a> (particleNode *, int)</td></tr>
<tr class="separator:a30323e7892f766f3cd64c24c7fbb2e39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed1e91505c85d438d9bf65f8d38ddf9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#aed1e91505c85d438d9bf65f8d38ddf9e">Particles_Set</a> (<a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:aed1e91505c85d438d9bf65f8d38ddf9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4065b98e0d61d7e5761155e57e25cb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#af4065b98e0d61d7e5761155e57e25cb4">Particles_SetID</a> (particleNode *)</td></tr>
<tr class="separator:af4065b98e0d61d7e5761155e57e25cb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987a4b58af67c2c29044f424f9f6fce3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a987a4b58af67c2c29044f424f9f6fce3">Particles_SetOutput</a> (<a class="el" href="struct_data.html">Data</a> *, <a class="el" href="struct_runtime.html">Runtime</a> *)</td></tr>
<tr class="separator:a987a4b58af67c2c29044f424f9f6fce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1265d39a904f2efb2990a5595893f70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#aa1265d39a904f2efb2990a5595893f70">Particles_ShowList</a> (particleNode *, int)</td></tr>
<tr class="separator:aa1265d39a904f2efb2990a5595893f70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed08e74514a4dc3b67a835cab9adf4ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#aed08e74514a4dc3b67a835cab9adf4ca">Particles_WriteBinary</a> (particleNode *, double, <a class="el" href="struct_output.html">Output</a> *, char *)</td></tr>
<tr class="separator:aed08e74514a4dc3b67a835cab9adf4ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add19fe19608225469f957dc67f11b149"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#add19fe19608225469f957dc67f11b149">Particles_WriteData</a> (<a class="el" href="struct_data.html">Data</a> *d, <a class="el" href="struct_output.html">Output</a> *, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:add19fe19608225469f957dc67f11b149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9801f8f2cf3e24a2158af136d81b3afa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="particles_8h.html#a9801f8f2cf3e24a2158af136d81b3afa">Particles_WriteTrajectory</a> (Particle *, char)</td></tr>
<tr class="separator:a9801f8f2cf3e24a2158af136d81b3afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains basic macro definitions, structure definitions and global variable declarations used by the Particle module.</p>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'to'+'.in'+'fn'+'.it'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@t<span style="display: none;">.nosp@m.</span>o.inf<span style="display: none;">.nosp@m.</span>n.it</a>)<br />
 B. Vaidya D. Mukherjee</dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 19, 2021 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0dc3734ada35f3a940a8c5526a722df3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dc3734ada35f3a940a8c5526a722df3">&#9670;&nbsp;</a></span>PARTICLES_CR_C</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_C&#160;&#160;&#160;1.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the artificial value of the speed of light </p>

</div>
</div>
<a id="a001da34d28357b683b4b3b865532cca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a001da34d28357b683b4b3b865532cca5">&#9670;&nbsp;</a></span>PARTICLES_CR_E_MC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_E_MC&#160;&#160;&#160;1.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Charge to mass ratio for CR particles [CR particles]. </p>

</div>
</div>
<a id="afc366ac7d2a83e303e6bb4e568421c6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc366ac7d2a83e303e6bb4e568421c6a">&#9670;&nbsp;</a></span>PARTICLES_CR_E_MC_GAS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_E_MC_GAS&#160;&#160;&#160;1.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Charge to mass ratio for the fluid [CR Particles]. </p>

</div>
</div>
<a id="ad53695c1daf170150186cf32e2195745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad53695c1daf170150186cf32e2195745">&#9670;&nbsp;</a></span>PARTICLES_CR_FEEDBACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_FEEDBACK&#160;&#160;&#160;YES</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enable / disable CR particle feedback onto the gas [CR particles]. </p>

</div>
</div>
<a id="a739ac7539d3db0797dec587fb5c311ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a739ac7539d3db0797dec587fb5c311ff">&#9670;&nbsp;</a></span>PARTICLES_CR_GC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_GC&#160;&#160;&#160;NO</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set Guiding center approx to NO by default. </p>

</div>
</div>
<a id="ac2d3e750fd8b7670e0ebfc1a79a1b1a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2d3e750fd8b7670e0ebfc1a79a1b1a9">&#9670;&nbsp;</a></span>PARTICLES_CR_LARMOR_EPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_LARMOR_EPS&#160;&#160;&#160;0.3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fraction of Larmor time (1/OmegaL) covered during one hydro time step [CR particles] </p>

</div>
</div>
<a id="a25926d518ea0b6d6fda0bdd4db47b9c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25926d518ea0b6d6fda0bdd4db47b9c1">&#9670;&nbsp;</a></span>PARTICLES_CR_MAX_FILE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_MAX_FILE_SIZE&#160;&#160;&#160;1.9 /* In GB */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default size of particle binary files </p>

</div>
</div>
<a id="a17512da4846b2ff968b1e7c39fcbe26f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17512da4846b2ff968b1e7c39fcbe26f">&#9670;&nbsp;</a></span>PARTICLES_CR_NCELL_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_NCELL_MAX&#160;&#160;&#160;1.8</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum number of zones crossed during one sub-cycle [CR particles]. </p>

</div>
</div>
<a id="ab00c02aa2ecf37d7a3cab367a00ecc27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab00c02aa2ecf37d7a3cab367a00ecc27">&#9670;&nbsp;</a></span>PARTICLES_CR_NSUB</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_NSUB&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max number of particles time steps per hydro step. When set to a negative integer, force sub-stepping to be the same [CR particles]. </p>

</div>
</div>
<a id="af72e43513336985fecb8307039e1fd15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af72e43513336985fecb8307039e1fd15">&#9670;&nbsp;</a></span>PARTICLES_CR_PREDICTOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_CR_PREDICTOR&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Predictor step in mover. This makes the scheme 2nd order [CR particles]. </p>

</div>
</div>
<a id="a8020885d4756c4ecdfa60386b227c0a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8020885d4756c4ecdfa60386b227c0a9">&#9670;&nbsp;</a></span>PARTICLES_DUST_FEEDBACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_DUST_FEEDBACK&#160;&#160;&#160;YES</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enable / disable dust particle feedback onto the gas [Dust particles]. </p>

</div>
</div>
<a id="a82f827e1a4f94bcd71138599d6542211"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82f827e1a4f94bcd71138599d6542211">&#9670;&nbsp;</a></span>PARTICLES_DUST_MAX_FILE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_DUST_MAX_FILE_SIZE&#160;&#160;&#160;1.9 /* In GB */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default size of particle binary files </p>

</div>
</div>
<a id="a8bcace04494190e33661aea1fa3a2c47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bcace04494190e33661aea1fa3a2c47">&#9670;&nbsp;</a></span>PARTICLES_DUST_STOPPING_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_DUST_STOPPING_TIME&#160;&#160;&#160;CONSTANT</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the particle stopping time to be consant (CONSTANT) or user-defined (USERDEF). </p>

</div>
</div>
<a id="ad9cc285cf19b8dde063c8bbd0c63b346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9cc285cf19b8dde063c8bbd0c63b346">&#9670;&nbsp;</a></span>PARTICLES_DUST_TIME_STEPPING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_DUST_TIME_STEPPING&#160;&#160;&#160;EXP_MIDPOINT</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Particles pusher (<code>EXP_MIDPOINT</code> or <code>SEMI_IMPLICIT</code>) [Dust particles]. </p>

</div>
</div>
<a id="ae0f564fadd168f15ee28f0c3e7ec76ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0f564fadd168f15ee28f0c3e7ec76ba">&#9670;&nbsp;</a></span>PARTICLES_LP_MAX_FILE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARTICLES_LP_MAX_FILE_SIZE&#160;&#160;&#160;1.9 /* In GB */</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default size of particle binary files </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac89499ef2571f49484ba430dacfd8452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac89499ef2571f49484ba430dacfd8452">&#9670;&nbsp;</a></span>Particles_Boundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Boundary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets physical boundary conditions on particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to PLUTO grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab85c19b7498aebbc5657df4f756751c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab85c19b7498aebbc5657df4f756751c6">&#9670;&nbsp;</a></span>Particles_BoundaryCheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Particles_BoundaryCheck </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if a particle is in the ghost zones or outside the whole computational domain.</p>
<pre class="fragment"> &lt;---------&gt;                               &lt;---------&gt;
| last |      |  .... Active Domain ....    |      | last |
</pre><p>xb2 xb1 xb0 xe0 xe1 xe2</p>
<p>Here 'last' marks the very last (or first) ghost zones. If a particle lies here, then deposition may not be done correctly.</p>
<dl class="section return"><dt>Returns</dt><dd>This function returns:<ul>
<li>0 if the particle is in the active domain</li>
<li>1 if the particle is in the ghost zones, but in the last one</li>
<li>2 if the particle is in the last ghost zone</li>
<li>3 if the particle is outside the whole comput. domain </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a4fae93653fc55623ddf2e0fca5bee8a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fae93653fc55623ddf2e0fca5bee8a7">&#9670;&nbsp;</a></span>Particles_BoundaryExchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_BoundaryExchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>In parallel mode, exchange/duplicate particles between neighbour processor. The function is done direction-wise: if a particle escapes from the left (right) boundary it is sent to the left (right) processor. The exchange is repeated direction by direction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the PLUTO grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad7e4bca61b635351a74d0fee6934be72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e4bca61b635351a74d0fee6934be72">&#9670;&nbsp;</a></span>Particles_CheckAll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long Particles_CheckAll </td>
          <td>(</td>
          <td class="paramtype">particleNode *&#160;</td>
          <td class="paramname"><em>PHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count and return the number of particles inside a given region of the computational domain. By default (buf=0) the region is the active part of the domain (ghost zone excluded). This region may be enlarged by an additional buffer of nbuf zones in the ghost zones </p>

</div>
</div>
<a id="a5f1a8c2edbf6fe89d2b7f0c62857a3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f1a8c2edbf6fe89d2b7f0c62857a3b7">&#9670;&nbsp;</a></span>Particles_CheckSingle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Particles_CheckSingle </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if the particle belongs to the local processor domain</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>pointer to Particle structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbuf</td><td>extra layer of ghost zones nbuf = 0 check if particle is in active domain; nbuf = 1 check if particle is in active zones + 1 layer of ghost zones, and so forth;</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if the particle is inside the specified region. FALSE otherwise. </dd></dl>

</div>
</div>
<a id="af31f13443a50301901c3317151c0bb71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af31f13443a50301901c3317151c0bb71">&#9670;&nbsp;</a></span>Particles_CR_ComputeCurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_ComputeCurrent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute Fcr (Lorentz force felt by particles and fluid) at cell centers. Force is computed by depositing charge and current from individual particles to the grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">V</td><td>3D array of primitive variables, V[nv][k][j][i] </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>PLUTO <a class="el" href="struct_data.html">Data</a> structure, containing d-&gt;Fcr[] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>array of grid structures </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0b8b72a010a1c78ede2bcb3f98df05a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b8b72a010a1c78ede2bcb3f98df05a1">&#9670;&nbsp;</a></span>Particles_CR_ComputeForce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_ComputeForce </td>
          <td>(</td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">V</td><td>3D array of primitive variables, V[nv][k][j][i] </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">data</td><td>PLUTO <a class="el" href="struct_data.html">Data</a> structure, containing d-&gt;Fcr[] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>array of grid structures </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3616941575bf6103f0b2c19ecaef28ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3616941575bf6103f0b2c19ecaef28ec">&#9670;&nbsp;</a></span>Particles_CR_ConservativeFeedback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_ConservativeFeedback </td>
          <td>(</td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>Fcr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *&#160;</td>
          <td class="paramname"><em>box</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add source term to the right hand side of the conservative MHD equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">U</td><td>An array of conserved quantities, U[k][j][i][nv] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Fcr</td><td>An array containing the CR feedback, Fcr[4][k][j][i] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>The time step increment </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>A pointer to a <a class="el" href="struct_r_box.html">RBox</a> structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac627e61f54597c02f931a181eebef606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac627e61f54597c02f931a181eebef606">&#9670;&nbsp;</a></span>Particles_CR_Flux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_Flux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add CR flux contribution to MHD fluxes. On input, it requires <code>state-&gt;Fcr</code> to be already computed. On output, it returns <code>state-&gt;fluxCR</code>. </p>

</div>
</div>
<a id="a9498cb6e93a52f41c61c9fbd44d573a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9498cb6e93a52f41c61c9fbd44d573a7">&#9670;&nbsp;</a></span>Particles_CR_Predictor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_Predictor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance particle velocity and speed by dt using an implicit-explicit 1st order scheme. Compute Fcr at F(t+dt), then restore particles into their original position.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>[in/out] PLUTO data array </td></tr>
    <tr><td class="paramname">dt</td><td>[in] Time step to be achieved </td></tr>
    <tr><td class="paramname">grid</td><td>[in] pointer to <a class="el" href="struct_grid.html">Grid</a> structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0422db2093f51effd6b41e7e08d92c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0422db2093f51effd6b41e7e08d92c6d">&#9670;&nbsp;</a></span>Particles_CR_States1DCopy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_States1DCopy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sweep.html">Sweep</a> *&#160;</td>
          <td class="paramname"><em>sweep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load Fcr from 3D data into 1D state structures. This is needed later to compute the flux (Particles_CR_Flux). </p>

</div>
</div>
<a id="ac5c203aa7f0c6dd105aeb050396dbcfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5c203aa7f0c6dd105aeb050396dbcfa">&#9670;&nbsp;</a></span>Particles_CR_StatesSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_StatesSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sweep.html">Sweep</a> *&#160;</td>
          <td class="paramname"><em>sweep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add CR flux-difference and source term contributions to L/R primitive states during the predictor step of CTU algorithm. Note that, although the update should be done in conservative variables, we choose to directly update primitive variables by performing, in place, a conservative-to-primitive recovery so that: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left\{\begin{array}{lcl} \vec{m}_\pm &amp;\leftarrow&amp; \DS \vec{m}_\pm - \frac{\Delta t}{2}\vec{F}_{CR} \\ \noalign{\medskip} \vec{B}_\pm &amp;\leftarrow&amp; \DS \vec{B}_\pm + \frac{\Delta t}{2}\nabla_x\times \left(\frac{\vec{F}_{CR}}{q_g}\right) \\ \noalign{\medskip} {\cal E}_\pm &amp;\leftarrow&amp; \DS {\cal E}_\pm - \frac{\Delta t}{2}\nabla_x\cdot \left(\frac{\vec{F}_{CR}\times\vec{B}}{q_g} + \vec{F}_{CR}\cdot\vec{v}\right) \end{array}\right. \quad\Longrightarrow\quad \left\{\begin{array}{lcl} \vec{v}_1 &amp;=&amp; \vec{v}_0 + \Delta\vec{v} \\ \noalign{\medskip} \vec{B}_1 &amp;=&amp; \vec{B}_0 + \Delta\vec{B} \\ \noalign{\medskip} (\rho e)_1 &amp;=&amp; \DS (\rho e)_0 + \frac{\rho}{2}(\vec{v}_0^2 - \vec{v}_1^2) + \frac{1}{2}\left(\vec{B}_0^2-\vec{B}_1^2\right) + \Delta {\cal E}; \end{array}\right. \]" src="form_229.png"/>
</p>
<p>Note that curl and divergence operators are discretized using finite differences of <code>fluxCR</code> computed in <a class="el" href="particles__cr__feedback_8c.html#a8f1ca28591574203fd95e3d854cb1576">Particles_CR_Flux()</a>.</p>
<p>This step is done only for the primitive Hancock / Char. Trac. schemes since these are carried out in primitive variables. This step is not needed for the conservative Hancock scheme since these terms are included during the predictor.</p>
<p>For source terms not involving derivatives, we include <em>ALL</em> of the components here since no other partcles-related source term will be added during the transverse predictors. For source terms involving derivatives, we include only the normal components since the transverse predictor will add the other components through Riemann solver. </p>

</div>
</div>
<a id="af9a0a975bdb2166dbc069b8bf9141e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9a0a975bdb2166dbc069b8bf9141e98">&#9670;&nbsp;</a></span>Particles_CR_Update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_Update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtime_step.html">timeStep</a> *&#160;</td>
          <td class="paramname"><em>Dts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance particle by a step dt.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td><a class="el" href="struct_data.html">Data</a> structure (contains paeticles list) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Dts</td><td><a class="el" href="structtime_step.html">timeStep</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>time time increment </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> structure</td></tr>
  </table>
  </dd>
</dl>
<p>Update particles position and velocity by a step dt considering the guiding center approximation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td><a class="el" href="struct_data.html">Data</a> structure (contains particles list) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Dts</td><td><a class="el" href="structtime_step.html">timeStep</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>time increment </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6508e68e661863384cc3347b3c313281"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6508e68e661863384cc3347b3c313281">&#9670;&nbsp;</a></span>Particles_Density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Density </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>qd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Simple deposition function used to compute particle density on the grid. </p>

</div>
</div>
<a id="aa41093725769044e70a7802e4ead0494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa41093725769044e70a7802e4ead0494">&#9670;&nbsp;</a></span>Particles_Deposit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Deposit </td>
          <td>(</td>
          <td class="paramtype">particleNode *&#160;</td>
          <td class="paramname"><em>PHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(Particle *, double *)&#160;</td>
          <td class="paramname"><em>Func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PHead</td><td>pointer to particle Node </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Func()</td><td>pointe to function containing the quantity to be deposited on the grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Q</td><td>The 4D data array on which func is deposited </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nelem</td><td>the number of elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>Pointer to a grid structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8407010c44fc5f3e3f01a5161c7c223c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8407010c44fc5f3e3f01a5161c7c223c">&#9670;&nbsp;</a></span>Particles_DepositBoundaryExchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_DepositBoundaryExchange </td>
          <td>(</td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Exchange boundary values between processors to complete the deposition process. If Q contains quantities in the boundaries, we first copy these values into auxiliary buffers <code>snd_bufL</code> and <code>snd_bufR</code> and then transfer them through an MPI Send/Recv call:</p>
<div class="fragment"><div class="line">Rank #0        A0|B0------C0|D0</div><div class="line">                          ^   |</div><div class="line">                          |   v </div><div class="line">Rank #1                   A1|B1------C1|D1</div><div class="line">                                     ^   |</div><div class="line">                                     |   v</div><div class="line">Rank #2                              A2|B2------C2|D2</div></div><!-- fragment --><p>Seen from rank # 1, we have</p><ul>
<li><code>A1</code> = snd_bufL</li>
<li><code>D1</code> = snd_bufR</li>
<li><code>D0</code> = rcv_bufL</li>
<li><code>A2</code> = rcv_bufR</li>
</ul>
<p>Here 'L' or 'R' refer to the processor to the left (rank #0) and to the right (rank #2), respectively. In 2D or 3D we iterate over dimensions. </p>

</div>
</div>
<a id="a60df801585965a19256fbf9b1ccc2a7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60df801585965a19256fbf9b1ccc2a7e">&#9670;&nbsp;</a></span>Particles_Destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Destroy </td>
          <td>(</td>
          <td class="paramtype">particleNode *&#160;</td>
          <td class="paramname"><em>curr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroy the input node *curr and update linked list.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">curr</td><td>pointer to concerned particleNode that has to be deleted from the list. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>pointer to PLUTO <a class="el" href="struct_data.html">Data</a> structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4bd06eba30f4c911988352f37b5d667e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bd06eba30f4c911988352f37b5d667e">&#9670;&nbsp;</a></span>Particles_Display()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Display </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prints the relevant quantities for particular particle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>pointer to Particle structure whose values are to be printLoged. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac884cda951c31b943566ba18698a9d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac884cda951c31b943566ba18698a9d23">&#9670;&nbsp;</a></span>Particles_Dust_ConservativeFeedback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Dust_ConservativeFeedback </td>
          <td>(</td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>Fdust</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *&#160;</td>
          <td class="paramname"><em>box</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Conservative feedback:</p>
<p>( v)_g -= dt*rho(dust)*F</p>
<p>Here F is the acceleration drag. </p>

</div>
</div>
<a id="a6b39f316bb6a101f319cacc9587bf8cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b39f316bb6a101f319cacc9587bf8cd">&#9670;&nbsp;</a></span>Particles_Dust_StatesSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Dust_StatesSource </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sweep.html">Sweep</a> *&#160;</td>
          <td class="paramname"><em>sweep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Data_Arr&#160;</td>
          <td class="paramname"><em>Fdust</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add drag source term to L/R sweeps during the predictor step of CTU algorithm. </p>

</div>
</div>
<a id="af9612318dfd68b55fd709e8d84f0a5a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9612318dfd68b55fd709e8d84f0a5a6">&#9670;&nbsp;</a></span>Particles_Dust_Update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Dust_Update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtime_step.html">timeStep</a> *&#160;</td>
          <td class="paramname"><em>Dts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Position Verlet Algorithm for updating dust particles</p>
<p>With FARGO, we solve</p>
<p>dx/dt = v' dv'/dt = a'</p>
<p>A separate advection step is carried out to account for orbital advection (y -&gt; y - q*Omega*dt) </p>

</div>
</div>
<a id="ab9f5cb6175c067b45e6ea5b1bf801d5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9f5cb6175c067b45e6ea5b1bf801d5c">&#9670;&nbsp;</a></span>Particles_GetWeights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_GetWeights </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute particle weights such that </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ q_p = \sum_{ij} w_{ij} Q_{ij} \]" src="form_247.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>pointer to particle structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cell</td><td>a 3-element array containing the indices (i,j,k) of the grid cell that is closer and to the left of the particle. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">w</td><td>a 3x3x3 array containing the weights </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>a pointer to an array of <a class="el" href="struct_grid.html">Grid</a> structures </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a53cd749391ba53882f12644323c30ea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53cd749391ba53882f12644323c30ea7">&#9670;&nbsp;</a></span>Particles_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets initial conditions on particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the PLUTO grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9595493f6cda3f018df22a61982dcf09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9595493f6cda3f018df22a61982dcf09">&#9670;&nbsp;</a></span>Particles_Inject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Inject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inject particles as you wish.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Pointer to the PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the PLUTO grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a120cd31043219b8e5e5693c65cd36757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a120cd31043219b8e5e5693c65cd36757">&#9670;&nbsp;</a></span>Particles_Insert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Particles_Insert </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>dummy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Insert a new particle in the linked list, if it lies on the local processor domain. Particle id is set to -1 by default.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dummy</td><td>pointer to the particle structure to be added to the linked list. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>pointer to the PLUTO <a class="el" href="struct_data.html">Data</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>specifies the action (see table). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to an array of <a class="el" href="struct_grid.html">Grid</a> structures.</td></tr>
  </table>
  </dd>
</dl>
<center> <table class="doxtable">
<tr>
<th>Action </th><th>Ownership Check</th><th>Set Id </th><th>Insert  </th></tr>
<tr>
<td>PARTICLES_CREATE </td><td>Yes </td><td>No </td><td>Yes </td></tr>
<tr>
<td>PARTICLES_CREATE_WITH_ID </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>PARTICLES_RESTART </td><td>Yes </td><td>No </td><td>Yes </td></tr>
<tr>
<td>PARTICLES_TRANSFER </td><td>No </td><td>No </td><td>Yes </td></tr>
</table>
</center><p>Note that when mode == PARTICLES_TRANSFER we do not check the ownership since a particle in a corner boundary has to be transferred twice and only after the second call to Particles_Insert will actually lie in the active domain.</p>
<dl class="section return"><dt>Returns</dt><dd>Return TRUE if particle was added to the list. FALSE otherwise. </dd></dl>

</div>
</div>
<a id="a8876f5cf3444c952a5db18f2371bf956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8876f5cf3444c952a5db18f2371bf956">&#9670;&nbsp;</a></span>Particles_Interpolate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Particles_Interpolate </td>
          <td>(</td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>indx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Interpolate a grid quantity V to particle position x.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">V</td><td>a 3D array defined on the fluid grid-&gt; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>a 3x3x3 array containing the weights </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">indx</td><td>a 3 element array giving the starting indices (i,j,k).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The interpolated value of V at the desired location. </dd></dl>

</div>
</div>
<a id="a1ff9c08bc507d454ec0e64342040321b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ff9c08bc507d454ec0e64342040321b">&#9670;&nbsp;</a></span>Particles_InterpolateArr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_InterpolateArr </td>
          <td>(</td>
          <td class="paramtype">double ****&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfield</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>indx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Similar to <a class="el" href="particles__tools_8c.html#a912896ce2de01a953b07689d618a29b9">Particles_Interpolate</a>, but performs the interpolation on n_field directly</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">V</td><td>a 4D array containing 3D arrays defined on the grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nfield</td><td>the number of arrays to be interpolated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>a 3x3x3 array containing the weights </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">indx</td><td>a 3 element array giving the starting indices (i,j,k). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v</td><td>a nfield element array containing interpolated values </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4e7790d4543a7119d2f94495fbaaeff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e7790d4543a7119d2f94495fbaaeff2">&#9670;&nbsp;</a></span>Particles_ListToArray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_ListToArray </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a linked list into an array of pointers. This function must be called only after particles have been redistributed. </p>

</div>
</div>
<a id="a64174d43c048d24f723255145d8f4517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64174d43c048d24f723255145d8f4517">&#9670;&nbsp;</a></span>Particles_LoadUniform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LoadUniform </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xbeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>coor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute particles coordinate assuming a regular spacing given by l = 1/(n)^(1/d) where d is the number of spatial dimensions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>an integer giving the particle counter inside the region [xbeg, xend] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntot</td><td>the total number of particles inside the region [xbeg, xend] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xbeg</td><td>an array specifying the coordinates of the lower bound in the domain to be filled </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xend</td><td>an array specifying the coordinates of the upper bound in the domain to be filled </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">coor</td><td>an array containing the particle position </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a71844c8b2f61e8804b97a968213ff209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71844c8b2f61e8804b97a968213ff209">&#9670;&nbsp;</a></span>Particles_LocateCell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Particles_LocateCell </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>indx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine the index of the computational zone hosting the particle, <img class="formulaInl" alt="$ x_{i-\HALF} &lt;= x_p &lt; x_{i+\HALF} $" src="form_246.png"/>. The search extends to the entire computational domain, including active and ghost zones.</p>
<p>This function works for both uniform and stretched grids and employs a binary search algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xp</td><td>a 3-element array specifying the particle position </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">indx</td><td>a 3-element array giving the cell coordinate (i,j,k) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>a pointer to an array of grid structures.</td></tr>
  </table>
  </dd>
</dl>
<p>Return 0 on success, 1 on error. </p>

</div>
</div>
<a id="ae1ab256b348bbcd7bfee071f09fa8db5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ab256b348bbcd7bfee071f09fa8db5">&#9670;&nbsp;</a></span>Particles_LP_ComputeShockNormalSpeed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_ComputeShockNormalSpeed </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>nhat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vshk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute Shock speed and Normal Unit Vector using the Coplanarity theorem (See. Schwartz 1998 Chapter on Shocks).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle Structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nhat</td><td>1D Vector for the Shock Normal. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vshk</td><td>Shock Speed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1e2795f900e6a4709251b13c3db5ab70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e2795f900e6a4709251b13c3db5ab70">&#9670;&nbsp;</a></span>Particles_LP_FixValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_FixValue </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">particleProbe *&#160;</td>
          <td class="paramname"><em>probe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function finds the cell of the particles and fix all the phisical variables, interpolating them on the particle coordinates. Call this routine only after pl-&gt;coor have been correctly initialized or calculated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the <a class="el" href="struct_data.html">Data</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the PLUTO grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af10392322e920fb3f1b3eedbba3028b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af10392322e920fb3f1b3eedbba3028b3">&#9670;&nbsp;</a></span>Particles_LP_FlagShock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_FlagShock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char ***&#160;</td>
          <td class="paramname"><em>flag2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flag cells that are shocked. The condition used is same as that used for the fluid. i.e., divV &lt; 0.0, |GradP|/P &gt; Threshold.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the data structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the grid structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">flag2</td><td>3D Array of the flagged zones. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4786855e00681991d540a36d4a3c3cc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4786855e00681991d540a36d4a3c3cc1">&#9670;&nbsp;</a></span>Particles_LP_Get_3mag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_Get_3mag </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>b4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the three components of magnetic field vector. from magnetic field four vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">b4</td><td><a class="el" href="struct_output.html">Output</a> four magnetic field vector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lf</td><td>Lorentz factor. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v3</td><td>1D Primitive vector with Magnetic field. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa8be40ee15cdb6c333fb2947976d398f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8be40ee15cdb6c333fb2947976d398f">&#9670;&nbsp;</a></span>Particles_LP_Get_4vel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_Get_4vel </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute Four velocity from three velocity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v3</td><td>1D Array of primitive variables. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lf</td><td>Lorentz factor. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">u4</td><td><a class="el" href="struct_output.html">Output</a> four velocity vector. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a83f71d581558bb93438b530309a78994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83f71d581558bb93438b530309a78994">&#9670;&nbsp;</a></span>Particles_LP_GetEmaxAtShock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Particles_LP_GetEmaxAtShock </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">particleProbe *&#160;</td>
          <td class="paramname"><em>probe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AccEff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the maximum energy of the injected energy spectrum that needs to be updated when the macro-particle crosses the shock. See Mimica 2009 &amp; Fromm 2016.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle Structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AccEff</td><td>Acceleration Efficiency depends on Free Turbulence Parameter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maximum energy [in code units] of the updated spectrum </dd></dl>

</div>
</div>
<a id="a40c4e72cb89245512be404e78a8e4ee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40c4e72cb89245512be404e78a8e4ee2">&#9670;&nbsp;</a></span>Particles_LP_IC_Emissivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_IC_Emissivity </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq_GHz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ThObs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>JnuIC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimates the power emitted by an ensemble of electron N(E) with Isotropic radiation field of CMB photons. For non-relativistic flow approximations in the Thompson's limit are taken from Petruk et. al. 2009, typically used for Supernovae. For the relativistic flow approximations in the Thompson's limit used here are adopted from Dermer et. al. 1995. The relativistic implementation therefore account of beaming of incident CMB photon and also related relativistic effects. The output &ndash;&gt; Total InverseCompton emissivity at the prescribed frequency is obtained in units of ergs/(s*cm^3*str)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle Structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freq_GHz</td><td>Observed frequency of InverseCompton radiation in GHz. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ThObs</td><td>Line of Sight Angle subtended from the Z axis in degrees. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">JnuIC</td><td>Total InverseCompton emissivity at the prescribed frequency </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa25efc6f0b23d587c1711fb9f0176754"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25efc6f0b23d587c1711fb9f0176754">&#9670;&nbsp;</a></span>Particles_LP_InitSpectra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_InitSpectra </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize spectra for each particle (only for LAGRANGIAN). Specify here the initial distribution of N(E) with E for each particle</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acd08c8c1aa8a2f383f7965d44918f6ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd08c8c1aa8a2f383f7965d44918f6ce">&#9670;&nbsp;</a></span>Particles_LP_IntegrateSpectra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_IntegrateSpectra </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>totE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Integrate particle spectrum to give total energy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the Particle structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">density</td><td>The fluid density interpolated on the particle. This must be provided even in pl-&gt;density is present, because IntegrateSpectra is called before LP_FIX at one time. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">totE</td><td>Integration of N(e)*e*de. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a37dd8f7dd4c6920ff4ea5489cdce65d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37dd8f7dd4c6920ff4ea5489cdce65d4">&#9670;&nbsp;</a></span>Particles_LP_SampleShock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_SampleShock </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">particleProbe *&#160;</td>
          <td class="paramname"><em>probe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute upstream and downstream fluid quantites as the particles crosses the shock. The density and velocity values are required for estimating the shock normal and shock speed and finally therefore the compression ratio.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the data structure. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">[in/out]</td><td>pl Pointer to the Particle structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ada139d986568a321ff2035e5d1399a0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada139d986568a321ff2035e5d1399a0d">&#9670;&nbsp;</a></span>Particles_LP_Sync_Emissivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_Sync_Emissivity </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>freq_GHz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ThObs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>JnuSync</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>StkQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>StkU</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Routine that computes the total synchrotrn emissivity and polarised Stoke Parameters for a given observed frequency and line of sight angle. The output is obtained in cgs units : ergs/(s*cm^3*Hz*str)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle Structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">freq_GHz</td><td>Observed frequency of synchrotron radiation in GHz. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ThObs</td><td>Line of Sight Angle subtended from the Z axis in degrees. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">JnuSync</td><td>Total synchrotron emissivity at the prescribed frequency </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">StkQ</td><td>Stoke Q Value from Linear Polarised Synchrotron emission. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">StkU</td><td>Stoke U Value from Linear Polarised Synchrotron emission. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a00567dfdd356f877c2bd47c950aa2bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00567dfdd356f877c2bd47c950aa2bb8">&#9670;&nbsp;</a></span>Particles_LP_Update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_Update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtime_step.html">timeStep</a> *&#160;</td>
          <td class="paramname"><em>Dts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>Time step dt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the PLUTO grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a56ab9fe6dce1d985e3da384a92b1938c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56ab9fe6dce1d985e3da384a92b1938c">&#9670;&nbsp;</a></span>Particles_LP_UpdateSpectra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_UpdateSpectra </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the spectral evolution of the particle. It detects if the particle has crossed the shock or not. If it has then the spectra is updated based on the compression ratio value of the shock. Otherwise, particle spectra is just updated accounting for radiative losses.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>Advection Time step. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac03bc80ed1e86d7d2e044728bd888150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac03bc80ed1e86d7d2e044728bd888150">&#9670;&nbsp;</a></span>Particles_Number()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Particles_Number </td>
          <td>(</td>
          <td class="paramtype">particleNode *&#160;</td>
          <td class="paramname"><em>PNodeRef</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Count and return the number of particles owned by the current process rnk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PNodeRef</td><td>pointer to headnode of the list whose count has to be estimated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa1b1dd72a729b186bf4915be6a3ceae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1b1dd72a729b186bf4915be6a3ceae4">&#9670;&nbsp;</a></span>Particles_Restart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Restart </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrestart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Routine for restarting from particles files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrestart</td><td>number of the restart data file given from command line </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the PLUTO grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a30323e7892f766f3cd64c24c7fbb2e39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30323e7892f766f3cd64c24c7fbb2e39">&#9670;&nbsp;</a></span>Particles_Select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Particle* Particles_Select </td>
          <td>(</td>
          <td class="paramtype">particleNode *&#160;</td>
          <td class="paramname"><em>PHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loop over particle and return the one with specified id.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PHead</td><td>pointer to the head node of the particle linked list. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>the particle id</td></tr>
  </table>
  </dd>
</dl>
<p>Return the particle (if any), or NULL </p>

</div>
</div>
<a id="aed1e91505c85d438d9bf65f8d38ddf9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed1e91505c85d438d9bf65f8d38ddf9e">&#9670;&nbsp;</a></span>Particles_Set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_Set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize particles on the grid and distribute them among processors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the PLUTO grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af4065b98e0d61d7e5761155e57e25cb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4065b98e0d61d7e5761155e57e25cb4">&#9670;&nbsp;</a></span>Particles_SetID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_SetID </td>
          <td>(</td>
          <td class="paramtype">particleNode *&#160;</td>
          <td class="paramname"><em>PHead</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign id to newly injected particles. The id is incrementally assigned starting from the global counter p_idCounter. </p><pre class="fragment">|--------------|--------------|--------------|--------------|
</pre><p> [A] 1,2,3 4,5 6 7,8 = N0</p>
<p>[B] +dn(0)=2 +dn(1)=5 +dn(2)=3 +dn(3)=4</p>
<p>The new id must take the value:</p>
<p>rank #0: 1,2,3, [N0+1, N0+dn(0)] rank #1: 4,5, [N0+dn(0)+1, N0+dn(0)+dn(1)+1] rank #2: 6, [N0+dn(0)+dn(1)+1, N0+dn(0)+dn(1)+dn(2)+1] ... </p>

</div>
</div>
<a id="a987a4b58af67c2c29044f424f9f6fce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987a4b58af67c2c29044f424f9f6fce3">&#9670;&nbsp;</a></span>Particles_SetOutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_SetOutput </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_runtime.html">Runtime</a> *&#160;</td>
          <td class="paramname"><em>runtime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set default attributes (variable names, pointers to data structures, filename extensions, etc...) of the particle output structures.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>pointer to <a class="el" href="struct_data.html">Data</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">runtime</td><td>pointer to <a class="el" href="struct_runtime.html">Runtime</a> structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa1265d39a904f2efb2990a5595893f70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1265d39a904f2efb2990a5595893f70">&#9670;&nbsp;</a></span>Particles_ShowList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_ShowList </td>
          <td>(</td>
          <td class="paramtype">particleNode *&#160;</td>
          <td class="paramname"><em>PHead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>show_particles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prints the memory addresses (and relevant quantities of particles) of the linked list.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PHead</td><td>pointer to headnode of the particle list. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">show_particles</td><td>An integer value, if set to 1 this routine will also display relevant quantities for every particle in the list. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aed08e74514a4dc3b67a835cab9adf4ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed08e74514a4dc3b67a835cab9adf4ca">&#9670;&nbsp;</a></span>Particles_WriteBinary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_WriteBinary </td>
          <td>(</td>
          <td class="paramtype">particleNode *&#160;</td>
          <td class="paramname"><em>PHeadRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt_particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_output.html">Output</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>useless_fname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write particle data in single or double precision binary format. The binary file structure is:</p>
<p>&lt;Header (ASCII) section&gt; {field1, field2, ...}_p All fields are mapped from the particle structure into an array and thus converted to either single or double precision, depending on the function that is being called. Fields can be scalars or array: for each particle nelem indicates the number of elements written for each particle. The field order does not have to match the structure member order but it must be consistent with the sequence declared in <a class="el" href="particles_8h.html#a987a4b58af67c2c29044f424f9f6fce3">Particles_SetOutput()</a> function. Individual fields may be excluded by calling <a class="el" href="set__output_8c.html#ad2d109c2afaafb23f500a9118e1e8cbc">SetOutputVar()</a> from ChangeOutputVar ().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PheadRef</td><td>Pointer to the Head Node of Particle List. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt_particles</td><td>Particle time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output</td><td>Pointer to output structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="add19fe19608225469f957dc67f11b149"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add19fe19608225469f957dc67f11b149">&#9670;&nbsp;</a></span>Particles_WriteData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_WriteData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_output.html">Output</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Main driver of particles output data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output</td><td>Pointer to the PLUTO <a class="el" href="struct_output.html">Output</a> strcuture. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9801f8f2cf3e24a2158af136d81b3afa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9801f8f2cf3e24a2158af136d81b3afa">&#9670;&nbsp;</a></span>Particles_WriteTrajectory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_WriteTrajectory </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write particle coordinates to an ASCII file, named "particle.&lt;id&gt;.dat" where &lt;id&gt; is the particle id. The file used a multiple column format,</p>
<p>&lt;t&gt; &lt;x1&gt; &lt;x2&gt; &lt;x3&gt; &lt;vx1&gt; &lt;vx2&gt; &lt;vx3&gt;</p>
<p>where &lt;t&gt; is the time column and the other contain coordinates and velocities.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>A pointer to a particle structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>Either "w" or "a" to write or append to the file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 26 2021 13:23:58 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
