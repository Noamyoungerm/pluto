<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/Particles/v00/particles_lp_spectra.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_9206b596ebf640a5bddb105d741e15ea.html">Particles</a></li><li class="navelem"><a class="el" href="dir_f3a980b7250a101508a76dea39b7e693.html">v00</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">particles_lp_spectra.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Tools needed to compute the quantities required to evolve the spectra and estimate the Emission coefficient.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0c0e5be2d26237bc592887259c4ff668"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v00_2particles__lp__spectra_8c.html#a0c0e5be2d26237bc592887259c4ff668">Get_4vel</a> (double *, double *, double *)</td></tr>
<tr class="separator:a0c0e5be2d26237bc592887259c4ff668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92a37da2665720c2f0842474afcbab54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v00_2particles__lp__spectra_8c.html#a92a37da2665720c2f0842474afcbab54">Get_3mag</a> (double *, double, double *)</td></tr>
<tr class="separator:a92a37da2665720c2f0842474afcbab54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116cc22316f76ed484a13d05264c973a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v00_2particles__lp__spectra_8c.html#a116cc22316f76ed484a13d05264c973a">UpdateUpstreamSpectra</a> (Particle *, <a class="el" href="struct_data.html">Data</a> *d, <a class="el" href="struct_grid.html">Grid</a> *, double, double, double, long int ***, double ***, double ***)</td></tr>
<tr class="separator:a116cc22316f76ed484a13d05264c973a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4006c89a7b8a2ff3fe262b1d94296af5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v00_2particles__lp__spectra_8c.html#a4006c89a7b8a2ff3fe262b1d94296af5">ApplyLorentzBoost</a> (double, double *, double *, double *)</td></tr>
<tr class="separator:a4006c89a7b8a2ff3fe262b1d94296af5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3090bcda9704cb1fd3be309d2b3c65c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v00_2particles__lp__spectra_8c.html#ab3090bcda9704cb1fd3be309d2b3c65c">RegridSpec</a> (double *, double *, double, double, int, int)</td></tr>
<tr class="separator:ab3090bcda9704cb1fd3be309d2b3c65c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26a4b1a00b6793332abae7e46aadf26b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v00_2particles__lp__spectra_8c.html#a26a4b1a00b6793332abae7e46aadf26b">locate_spec</a> (double *, double, int, int, int)</td></tr>
<tr class="separator:a26a4b1a00b6793332abae7e46aadf26b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabfabe0e6e0792e78d84cdd183c59840"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="v00_2particles__lp__spectra_8c.html#aabfabe0e6e0792e78d84cdd183c59840">Particles_LP_UpdateSpectra</a> (<a class="el" href="struct_data.html">Data</a> *d, double dt, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:aabfabe0e6e0792e78d84cdd183c59840"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Authors</dt><dd>B. Vaidya (<a href="#" onclick="location.href='mai'+'lto:'+'bva'+'id'+'ya@'+'ii'+'ti.'+'ac'+'.in'; return false;">bvaid<span style="display: none;">.nosp@m.</span>ya@i<span style="display: none;">.nosp@m.</span>iti.a<span style="display: none;">.nosp@m.</span>c.in</a>)<br />
 A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'to'+'.in'+'fn'+'.it'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@t<span style="display: none;">.nosp@m.</span>o.inf<span style="display: none;">.nosp@m.</span>n.it</a>)<br />
 D. Mukherjee (<a href="#" onclick="location.href='mai'+'lto:'+'dip'+'an'+'jan'+'.m'+'ukh'+'er'+'jee'+'@u'+'nit'+'o.'+'it'; return false;">dipan<span style="display: none;">.nosp@m.</span>jan.<span style="display: none;">.nosp@m.</span>mukhe<span style="display: none;">.nosp@m.</span>rjee<span style="display: none;">.nosp@m.</span>@unit<span style="display: none;">.nosp@m.</span>o.it</a>)</dd></dl>
<dl class="section date"><dt>Date</dt><dd>July 2nd, 2019 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4006c89a7b8a2ff3fe262b1d94296af5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4006c89a7b8a2ff3fe262b1d94296af5">&#9670;&nbsp;</a></span>ApplyLorentzBoost()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ApplyLorentzBoost </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vboost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>nboost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>unpf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lorentz transformation from one frame to other.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vboost</td><td>Velocity of the Boost </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nboost</td><td>1D Directional Vector of the boost. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unpf</td><td>Four vector of the quantity that needs to be transformed </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pf</td><td>Four vector of the quantity in the transformed frame. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a92a37da2665720c2f0842474afcbab54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92a37da2665720c2f0842474afcbab54">&#9670;&nbsp;</a></span>Get_3mag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Get_3mag </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>b4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the three components of magnetic field vector. from magnetic field four vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">b4</td><td><a class="el" href="struct_output.html">Output</a> four magnetic field vector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lf</td><td>Lorentz factor. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v3</td><td>1D Primitive vector with Magnetic field. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0c0e5be2d26237bc592887259c4ff668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c0e5be2d26237bc592887259c4ff668">&#9670;&nbsp;</a></span>Get_4vel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Get_4vel </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute Four velocity from three velocity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v3</td><td>1D Array of primitive variables. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lf</td><td>Lorentz factor. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">u4</td><td><a class="el" href="struct_output.html">Output</a> four velocity vector. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a26a4b1a00b6793332abae7e46aadf26b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26a4b1a00b6793332abae7e46aadf26b">&#9670;&nbsp;</a></span>locate_spec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int locate_spec </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ilg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ihg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Search ordered array to locate val in array (spectrum). Returns index i such that: ar[i] &lt;= val &lt; ar[i+1] If val &gt; ar[nlast-1], return i = nel If val &lt; ar[0], return i = -1</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ar</td><td>Pointer to input array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>Value to search </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nel</td><td>Length of array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilg</td><td>Guess value of lower bound. Give 0 if not known. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ihg</td><td>Guess value of upper bound. Give nel-1 if not known. ilg, ihg if given, helps achieve faster convergence. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aabfabe0e6e0792e78d84cdd183c59840"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabfabe0e6e0792e78d84cdd183c59840">&#9670;&nbsp;</a></span>Particles_LP_UpdateSpectra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_UpdateSpectra </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the spectral evolution of the particle. It detects if the particle has crossed the shock or not. If it has then the spectra is updated based on the compression ratio value of the shock. Otherwise, particle spectra is just updated accounting for radiative losses.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the data structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the grid structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>Advection Time step. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab3090bcda9704cb1fd3be309d2b3c65c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3090bcda9704cb1fd3be309d2b3c65c">&#9670;&nbsp;</a></span>RegridSpec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double RegridSpec </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Ein</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>inspec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Eout_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Eout_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>il</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ih</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Re-grid an input spectrum to a new energy bin array, preserving the total norm: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int \chi_{\rm old} dE = \int_{\rm new} dE \]" src="form_403.png"/>
</p>
<p>TODO: Present implementation equivalent to a FLAT reconstruction. Update to LINEAR or PPM if needed. To Check.</p>
<p>; Config 1: (indxh - indxl &gt;= 1) ; ; indxl indxh ;in: ------&mdash;|------&mdash;|------&mdash;|-------&mdash;|-&mdash; ;out: ---------&mdash;|-----------------&mdash;|-----------&mdash; ; pout_l pout_h </p><pre class="fragment">     Config 2: outspec[i] = inspec[il]*(pout_h - pout_l)
</pre><p> ; ; indxl ; indxh ;in: ------&mdash;|------&mdash;|------&mdash;|-------&mdash;|-&mdash; ;out: -------&mdash;|--&mdash;|---------------------------&mdash; ; pout_l pout_h ; ; Config 3: outspec[i] = inspec[nel1-1]*(pin[nel1] - pout_l) ; ; indxl ; indxh ;in: ------&mdash;| ;out: --&mdash;|----------&mdash;|&ndash; ; pout_l pout_h ; ; Config 4: outspec[i] = inspec[0]*(pout_h - pin[0]) ; ; indxl ; indxh ;in: |-------&mdash;|-&mdash; ;out: -----&mdash;|----&mdash;|----&mdash; ; pout_l pout_h </p>

</div>
</div>
<a id="a116cc22316f76ed484a13d05264c973a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a116cc22316f76ed484a13d05264c973a">&#9670;&nbsp;</a></span>UpdateUpstreamSpectra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpdateUpstreamSpectra </td>
          <td>(</td>
          <td class="paramtype">Particle *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_data.html">Data</a> *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eng_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>npart_shk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int ***&#160;</td>
          <td class="paramname"><em>Totpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>TotpartE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>TotpartN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the particle spectra as the particle pl passes through the shock. The energy grid is reset and the distribution becomes a predefined power-law. We initialize <img class="formulaInl" alt="$ \chi $" src="form_324.png"/> to be the volume average: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \chi = CE^{-p}\quad\rightarrow\quad \av{\chi}_i = \frac{C}{\Delta E_i} \int_{E_{i-\HALF}}^{E_{i+\HALF}} E^{-p}\, dE = \left\{\begin{array}{ll} \DS \frac{C}{\Delta E_i} \Big(E^{1-p}_{i+\HALF} - E^{1-p}_{i-\HALF}\Big) &amp; \qquad {\rm for} \quad p \ne 1 \\ \noalign{\medskip} \DS \frac{C}{\Delta E_i} \log\left(\frac{E_{i+\HALF}}{E_{i-\HALF}}\right) &amp; \qquad {\rm for} \quad p = 1 \end{array}\right. \]" src="form_334.png"/>
</p>
<p> The constant <img class="formulaInl" alt="$ C $" src="form_336.png"/> is chosen so that the total integral is gives the number of microparticles per unit (fluid) density: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{N_{\rm micro}}{\rho} = \int_{E_{\min}}^{E_{\max}} \chi\, dE = \sum_i \Delta E_i\av{\chi}_i = C (E_{\max}^{1-p} - E_{\min}^{1-p}) \quad\rightarrow\quad C = \frac{N_{\rm micro}}{\rho}\frac{1}{E_{\max}^{1-p} - E_{\min}^{1-p}} \]" src="form_340.png"/>
</p>
<ul>
<li>Note: spectra array: (0, nel-1), size: nel energy array : (0, nel), size: nel+1</li>
</ul>
<p>For locate_spec, if guess value of lower bound is ilg, guess upper bound is ilg+10 or nel, whichever is lower. Locate then searches within (ilg, ilg+10) or (ilg, nel). The choice of 10 cells is arbitrary. Smaller range gives faster convergence for locate. 10 should be sufficient for typical applications.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the Particle structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Electron spectral momentum index : p^{-q} </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eng_min</td><td>Minimum energy of the updated spectra </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eng_max</td><td>Maximum energy of the updated spectra. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 30 2019 19:52:03 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
