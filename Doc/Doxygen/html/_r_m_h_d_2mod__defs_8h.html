<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/RMHD/mod_defs.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_fd4515545972b382a4eb7f05fb6d5de5.html">RMHD</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mod_defs.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module header file for relativistic MHD (RMHD).  
<a href="#details">More...</a></p>

<p><a href="_r_m_h_d_2mod__defs_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_map__param.html">Map_param</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acc147764d039b00b039c05cb4d958d24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#acc147764d039b00b039c05cb4d958d24">RMHD_FAST_EIGENVALUES</a>&#160;&#160;&#160;NO</td></tr>
<tr class="separator:acc147764d039b00b039c05cb4d958d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f678f44939c59710d302012d3697b1f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#a9f678f44939c59710d302012d3697b1f">RMHD_REDUCED_ENERGY</a>&#160;&#160;&#160;YES</td></tr>
<tr class="separator:a9f678f44939c59710d302012d3697b1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c00f3fc7420082614eda30e2c81c687"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#a7c00f3fc7420082614eda30e2c81c687">ApproximateFastWaves</a> (double *, double, double, double *)</td></tr>
<tr class="separator:a7c00f3fc7420082614eda30e2c81c687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8326519eadf344e2e56660ad4993f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#adc8326519eadf344e2e56660ad4993f1">ConsToPrim</a> (double **, double **, int, int, unsigned char *)</td></tr>
<tr class="separator:adc8326519eadf344e2e56660ad4993f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead68fb45757da48ef0bc6c413160712"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#aead68fb45757da48ef0bc6c413160712">Flux</a> (const <a class="el" href="struct_state.html">State</a> *, int, int)</td></tr>
<tr class="separator:aead68fb45757da48ef0bc6c413160712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f838c5e3b0233613182a79f9e8eedb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#ac8f838c5e3b0233613182a79f9e8eedb">HLL_Speed</a> (const <a class="el" href="struct_state.html">State</a> *, const <a class="el" href="struct_state.html">State</a> *, double *, double *, int, int)</td></tr>
<tr class="separator:ac8f838c5e3b0233613182a79f9e8eedb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ed5ff2a52d088c0802888b8ad75212"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#ae1ed5ff2a52d088c0802888b8ad75212">MaxSignalSpeed</a> (const <a class="el" href="struct_state.html">State</a> *, double *, double *, int, int)</td></tr>
<tr class="separator:ae1ed5ff2a52d088c0802888b8ad75212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95dfdfc31eef9d5068aa8fa2f9608676"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#a95dfdfc31eef9d5068aa8fa2f9608676">PrimToCons</a> (double **, double **, int, int)</td></tr>
<tr class="separator:a95dfdfc31eef9d5068aa8fa2f9608676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7521e6b8ac6465f96b8db24045cd7a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#ae7521e6b8ac6465f96b8db24045cd7a3">VelocityLimiter</a> (double *, double *, double *)</td></tr>
<tr class="separator:ae7521e6b8ac6465f96b8db24045cd7a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10d660456b396c98428d542b73612968"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#a10d660456b396c98428d542b73612968">Magnetosonic</a> (double *vp, double cs2, double h, double *lambda)</td></tr>
<tr class="separator:a10d660456b396c98428d542b73612968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29455738945c1cde543e4a1809a3d346"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#a29455738945c1cde543e4a1809a3d346">RMHD_EnergySolve</a> (<a class="el" href="struct_map__param.html">Map_param</a> *)</td></tr>
<tr class="separator:a29455738945c1cde543e4a1809a3d346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ffa64e38d26388917234ad1b613d39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#a10ffa64e38d26388917234ad1b613d39">RMHD_PressureFix</a> (<a class="el" href="struct_map__param.html">Map_param</a> *)</td></tr>
<tr class="separator:a10ffa64e38d26388917234ad1b613d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade15b2dbc7c5eeb16cfb910e2ba9922d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#ade15b2dbc7c5eeb16cfb910e2ba9922d">HLL_DIVB_SOURCE</a> (const <a class="el" href="struct_sweep.html">Sweep</a> *, double **, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:ade15b2dbc7c5eeb16cfb910e2ba9922d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa238142f2d2c5df966efd480cb5f037a"><td class="memItemLeft" align="right" valign="top">Riemann_Solver&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_m_h_d_2mod__defs_8h.html#aa238142f2d2c5df966efd480cb5f037a">HLLD_Solver</a></td></tr>
<tr class="separator:aa238142f2d2c5df966efd480cb5f037a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Set label, indexes and basic prototyping for the relativistic MHD module.</p>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'to'+'.in'+'fn'+'.it'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@t<span style="display: none;">.nosp@m.</span>o.inf<span style="display: none;">.nosp@m.</span>n.it</a>)<br />
 C. Zanni (<a href="#" onclick="location.href='mai'+'lto:'+'zan'+'ni'+'@oa'+'to'+'.in'+'af'+'.it'; return false;">zanni<span style="display: none;">.nosp@m.</span>@oat<span style="display: none;">.nosp@m.</span>o.ina<span style="display: none;">.nosp@m.</span>f.it</a>)<br />
 G. Mattia </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Dec 03, 2019 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="acc147764d039b00b039c05cb4d958d24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RMHD_FAST_EIGENVALUES&#160;&#160;&#160;NO</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If set to YES, use approximate (and faster) expressions when computing the fast magnetosonic speed, see Sect. 3.3 of Del Zanna, A&amp;A (2006), 473. Solutions of quartic equation is avoided and replace with upper bounds provided by quadratic equation. </p>

</div>
</div>
<a class="anchor" id="a9f678f44939c59710d302012d3697b1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RMHD_REDUCED_ENERGY&#160;&#160;&#160;YES</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>By turning RMHD_REDUCED_ENERGY to YES, we let PLUTO evolve the total energy minus the mass density contribution. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7c00f3fc7420082614eda30e2c81c687"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ApproximateFastWaves </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cs2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute an approximate expression for the fast magnetosonic speed using the upper-bound estimated outlined by Leismann et al. (A&amp;A 2005, 436, 503), Eq. [27].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>an array of primitive variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cs2</td><td>the sound speed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>the specific entropy </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lambda</td><td>an array containing the fast magnetosonic speeds</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if an error occurred. </dd></dl>

</div>
</div>
<a class="anchor" id="adc8326519eadf344e2e56660ad4993f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ConsToPrim </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>ucons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>uprim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ibeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert from conservative to primitive variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ucons</td><td>array of conservative variables </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">uprim</td><td>array of primitive variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flag</td><td>array of flags tagging, in input, zones where entropy must be used to recover pressure and, on output, zones where conversion was not successful.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 if conversion was successful in all zones in the range [ibeg,iend]. Return 1 if one or more zones could not be converted correctly and either pressure, density or energy took non-physical values.</dd></dl>
<p>Convert a vector of conservative quantities to primitive values.</p>
<pre class="fragment">             -----&gt; use entropy ----&gt; p = p(S)
</pre><p> start with U { --&mdash;&gt; use energy --&mdash;&gt; p = p(E)</p>
<p>if p is not physical fix it. </p>

</div>
</div>
<a class="anchor" id="aead68fb45757da48ef0bc6c413160712"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Flux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to a state structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<p>Compute the component of the flux tensor normal to the direction of integration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to a state structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to a state structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<p>Compute the component of the flux tensor normal to the direction of integration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to a state structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>

</div>
</div>
<a class="anchor" id="ade15b2dbc7c5eeb16cfb910e2ba9922d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HLL_DIVB_SOURCE </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sweep.html">Sweep</a> *&#160;</td>
          <td class="paramname"><em>sweep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>Uhll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Include div.B source term to momentum, induction and energy equation. Used in conjunction with an HLL-type Riemann solver.</p>
<p>LAST_MODIFIED</p>
<p>Setp 18th 2008, by Andrea Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'to'+'.as'+'tr'+'o.i'+'t'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@t<span style="display: none;">.nosp@m.</span>o.ast<span style="display: none;">.nosp@m.</span>ro.i<span style="display: none;">.nosp@m.</span>t</a>) </p>

</div>
</div>
<a class="anchor" id="ac8f838c5e3b0233613182a79f9e8eedb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HLL_Speed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>stateL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>stateR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute leftmost (SL) and rightmost (SR) speeds for the Riemann fan.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stateL</td><td>pointer to a state structure for the left state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateR</td><td>pointer to a state structure for the right state </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SL</td><td>the (estimated) leftmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SR</td><td>the (estimated) rightmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Switches:</p>
<p>ROE_ESTIMATE (YES/NO), DAVIS_ESTIMATE (YES/NO). TVD_ESTIMATE (YES/NO) JAN_HLL (YES/NO)</p>
<p>These switches set how the wave speed estimates are going to be computed. Only one can be set to 'YES', and the rest of them must be set to 'NO'</p>
<p>ROE_ESTIMATE: b_m = (0, (u_R - c_R, u_L - c_L, u_{roe} - c_{roe})) b_m = (0, (u_R + c_R, u_L + c_L, u_{roe} + c_{roe}))</p>
<p>where u_{roe} and c_{roe} are computed using Roe averages.</p>
<p>DAVIS_ESTIMATE: b_m = (0, (u_R - c_R, u_L - c_L)) b_m = (0, (u_R + c_R, u_L + c_L))</p>
<p>Compute leftmost (SL) and rightmost (SR) speeds for the Riemann fan.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stateL</td><td>pointer to a state structure for the left state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateR</td><td>pointer to a state structure for the right state </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SL</td><td>the (estimated) leftmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SR</td><td>the (estimated) rightmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Switches:</p>
<p>ROE_ESTIMATE (YES/NO), DAVIS_ESTIMATE (YES/NO)</p>
<p>These switches set how the wave speed estimates are going to be computed. Only one can be set to 'YES', and the rest of them must be set to 'NO'</p>
<p>ROE_ESTIMATE: b_m = (0, (u_R - c_R, u_L - c_L, u_{roe} - c_{roe})) b_m = (0, (u_R + c_R, u_L + c_L, u_{roe} + c_{roe}))</p>
<p>where u_{roe} and c_{roe} are computed using Roe averages.</p>
<p>DAVIS_ESTIMATE: b_m = (0, (u_R - c_R, u_L - c_L)) b_m = (0, (u_R + c_R, u_L + c_L))</p>
<p>Compute leftmost (SL) and rightmost (SR) speeds for the Riemann fan.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stateL</td><td>pointer to a state structure for the left state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateR</td><td>pointer to a state structure for the right state </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SL</td><td>the (estimated) leftmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SR</td><td>the (estimated) rightmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a10d660456b396c98428d542b73612968"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Magnetosonic </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cs2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>lambda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find the four magneto-sonic speeds (fast and slow) for the relativistic MHD equations (RMHD). We follow the notations introduced in Eq. (16) in</p>
<p>Del Zanna, Bucciantini and Londrillo, A&amp;A, 400, 397&ndash;413, 2003</p>
<p>and also Eq. (57-58) of Mignone &amp; Bodo, MNRAS, 2006 for the degenerate cases.</p>
<p>The quartic equation is solved analytically and the solver (function 'QuarticSolve') assumes all roots are real (which should be always the case here, since eigenvalues are recovered from primitive variables). The coefficients of the quartic were found through the following MAPLE script: </p><pre class="fragment"> *   ------------------------------------------------
restart;

u[0] := gamma;
u[x] := gamma*v[x];
b[0] := gamma*vB;
b[x] := B[x]/gamma + b[0]*v[x];
wt   := w + b^2;

#############################################################
"fdZ will be equation (16) of Del Zanna 2003 times w_{tot}";

e2  := c[s]^2 + b^2*(1 - c[s]^2)/wt;
fdZ := (1-e2)*(u[0]*lambda - u[x])^4 + (1-lambda^2)*
       (c[s]^2*(b[0]*lambda - b[x])^2/wt - e2*(u[0]*lambda - u[x])^2);

########################################################
"print the coefficients of the quartic polynomial fdZ";

coeff(fMB,lambda,4);
coeff(fMB,lambda,3);
coeff(fMB,lambda,2);
coeff(fMB,lambda,1);
coeff(fMB,lambda,0);

fdZ := fdZ*wt;  

######################################################
"fMB will be equation (56) of Mignone &amp; Bodo (2006)";

a  := gamma*(lambda-v[x]);
BB := b[x] - lambda*b[0];
fMB := w*(1-c[s]^2)*a^4 - (1-lambda^2)*((b^2+w*c[s]^2)*a^2-c[s]^2*BB^2);

######################################
"check that fdZ = fMB";

simplify(fdZ - fMB);

########################################################
"print the coefficients of the quartic polynomial fMB";

coeff(fMB,lambda,4);
coeff(fMB,lambda,3);
coeff(fMB,lambda,2);
coeff(fMB,lambda,1);
coeff(fMB,lambda,0);


###############################################
"Degenerate case 2: Bx = 0, Eq (58) in MB06";

B[x] := 0;

a2 := w*(c[s]^2 + gamma^2*(1-c[s]^2)) + Q; 
a1 := -2*w*gamma^2*v[x]*(1-c[s]^2);
a0 := w*(-c[s]^2 + gamma^2*v[x]^2*(1-c[s]^2))-Q;

"delc is a good way to evaluate the determinant so that it is &gt; 0";
del  := a1^2 - 4*a2*a0;
delc := 4*(w*c[s]^2 + Q)*(w*(1-c[s]^2)*gamma^2*(1-v[x]^2) + (w*c[s]^2+Q));
simplify(del-delc);

############################################################################
"check the correctness of the coefficients of Eq. (58) in MB06";

Q  := b^2 - c[s]^2*vB^2;
divide(fMB, (lambda-v[x])^2,'fMB2');
simplify(a2 - coeff(fMB2,lambda,2)/gamma^2);
simplify(a1 - coeff(fMB2,lambda,1)/gamma^2);
simplify(a0 - coeff(fMB2,lambda,0)/gamma^2);</pre> 
</div>
</div>
<a class="anchor" id="ae1ed5ff2a52d088c0802888b8ad75212"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MaxSignalSpeed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the maximum and minimum characteristic velocities for the HD equations from the vector of primitive variables state-&gt;v.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the leftmost characteristic </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the rightmost characteristic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Compute the maximum and minimum characteristic velocities for the MHD equations, cmin= v - cf, cmax = v + cf</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the leftmost characteristic </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the rightmost characteristic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Return the rightmost (cmax) and leftmost (cmin) wave propagation speed in the Riemann fan</p>
<p>Compute the maximum and minimum propagation speeds for the RHD equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the leftmost characteristic </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the rightmost characteristic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a95dfdfc31eef9d5068aa8fa2f9608676"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimToCons </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>uprim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>ucons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ibeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert primitive variables to conservative variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uprim</td><td>array of primitive variables </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ucons</td><td>array of conservative variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Convert primitive variables in conservative variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uprim</td><td>array of primitive variables </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ucons</td><td>array of conservative variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Convert a vector of primitive quantities to conservative </p>

</div>
</div>
<a class="anchor" id="a29455738945c1cde543e4a1809a3d346"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RMHD_EnergySolve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_map__param.html">Map_param</a> *&#160;</td>
          <td class="paramname"><em>par</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve f(W) = 0, where f(W) is Equation (A4) or (A6).</p>
<dl class="section return"><dt>Returns</dt><dd>Error codes:<ul>
<li>0 = success</li>
<li>1 = negative energy</li>
<li>2 = negative pressure</li>
<li>3 = inaccurate solution (debug only)</li>
<li>4 = NaN </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a10ffa64e38d26388917234ad1b613d39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RMHD_PressureFix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_map__param.html">Map_param</a> *&#160;</td>
          <td class="paramname"><em>par</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Error codes are:<ul>
<li>0 = success</li>
<li>1 = v^2 &gt; 1</li>
<li>2 = too many iterations </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="ae7521e6b8ac6465f96b8db24045cd7a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VelocityLimiter </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the total reconstructed velocity is &gt; 1 If a superluminal value occurs, flatten distribution. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="aa238142f2d2c5df966efd480cb5f037a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HLLD_Solver</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve Riemann problem for the isothermal MHD equations using the three-states HLLD Riemann solver of Mignone (2007).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sweep</td><td>pointer to <a class="el" href="struct_sweep.html">Sweep</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial grid index </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">end</td><td>final grid index </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmax</td><td>1D array of maximum characteristic speeds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to array of <a class="el" href="struct_grid.html">Grid</a> structures. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 14 2020 21:28:57 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
