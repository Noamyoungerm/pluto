<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/RHD/mod_defs.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLUTO
   &#160;<span id="projectnumber">4.4-patch2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_7b05762d6e3c6ba660a688454579b2f1.html">RHD</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mod_defs.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Set labels, indexes and prototypes for the RHD module.  
<a href="#details">More...</a></p>

<p><a href="_r_h_d_2mod__defs_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_map__param.html">Map_param</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7a5c5ab355232d7a87c6f1cf73590447"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#a7a5c5ab355232d7a87c6f1cf73590447">ConsToPrim</a> (double **, double **, int, int, uint16_t *)</td></tr>
<tr class="separator:a7a5c5ab355232d7a87c6f1cf73590447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aead68fb45757da48ef0bc6c413160712"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#aead68fb45757da48ef0bc6c413160712">Flux</a> (const <a class="el" href="struct_state.html">State</a> *, int, int)</td></tr>
<tr class="separator:aead68fb45757da48ef0bc6c413160712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f838c5e3b0233613182a79f9e8eedb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#ac8f838c5e3b0233613182a79f9e8eedb">HLL_Speed</a> (const <a class="el" href="struct_state.html">State</a> *, const <a class="el" href="struct_state.html">State</a> *, double *, double *, int, int)</td></tr>
<tr class="separator:ac8f838c5e3b0233613182a79f9e8eedb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e8233df5137d8d45ca2448be4dc213"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#a20e8233df5137d8d45ca2448be4dc213">MaxSignalSpeed</a> (const <a class="el" href="struct_state.html">State</a> *, double *, double *, int, int)</td></tr>
<tr class="separator:a20e8233df5137d8d45ca2448be4dc213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a580a1aefbdab713f687716381afe48a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#a580a1aefbdab713f687716381afe48a2">PrimEigenvectors</a> (const <a class="el" href="struct_state.html">State</a> *, int, int)</td></tr>
<tr class="separator:a580a1aefbdab713f687716381afe48a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95dfdfc31eef9d5068aa8fa2f9608676"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#a95dfdfc31eef9d5068aa8fa2f9608676">PrimToCons</a> (double **, double **, int, int)</td></tr>
<tr class="separator:a95dfdfc31eef9d5068aa8fa2f9608676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf5a372097d87ad21cf5f967aad72d6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#adf5a372097d87ad21cf5f967aad72d6f">PrimRHS</a> (double *, double *, double, double, double *)</td></tr>
<tr class="separator:adf5a372097d87ad21cf5f967aad72d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86a8a63023b9c5df69e30846bd2576fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#a86a8a63023b9c5df69e30846bd2576fb">PrimSource</a> (const <a class="el" href="struct_state.html">State</a> *, double **, int, int, <a class="el" href="struct_grid.html">Grid</a> *)</td></tr>
<tr class="separator:a86a8a63023b9c5df69e30846bd2576fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1550e21bb1d5f31c99ab701dc8712f1f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#a1550e21bb1d5f31c99ab701dc8712f1f">RHD_EnergySolve</a> (double *, double *)</td></tr>
<tr class="separator:a1550e21bb1d5f31c99ab701dc8712f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a307e77dabc3c327f34e5c37923ee7e1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#a307e77dabc3c327f34e5c37923ee7e1d">RHD_EntropySolve</a> (double *, double *)</td></tr>
<tr class="separator:a307e77dabc3c327f34e5c37923ee7e1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33c3f435bed91b71be86da30e6c76c6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#ad33c3f435bed91b71be86da30e6c76c6">RHD_PressureFix</a> (double *, double *)</td></tr>
<tr class="separator:ad33c3f435bed91b71be86da30e6c76c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7521e6b8ac6465f96b8db24045cd7a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r_h_d_2mod__defs_8h.html#ae7521e6b8ac6465f96b8db24045cd7a3">VelocityLimiter</a> (double *, double *, double *)</td></tr>
<tr class="separator:ae7521e6b8ac6465f96b8db24045cd7a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains variable names and prototypes for the RHD module</p>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'mig'+'no'+'ne@'+'to'+'.in'+'fn'+'.it'; return false;">migno<span style="display: none;">.nosp@m.</span>ne@t<span style="display: none;">.nosp@m.</span>o.inf<span style="display: none;">.nosp@m.</span>n.it</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Dec 02, 2020 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7a5c5ab355232d7a87c6f1cf73590447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a5c5ab355232d7a87c6f1cf73590447">&#9670;&nbsp;</a></span>ConsToPrim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ConsToPrim </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>ucons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>uprim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert from conservative to primitive variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ucons</td><td>array of conservative variables </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">uprim</td><td>array of primitive variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flag</td><td>array of flags tagging, in input, zones where entropy must be used to recover pressure and, on output, zones where conversion was not successful.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 if conversion was successful in all zones in the range [ibeg,iend]. Return 1 if one or more zones could not be converted correctly and either pressure, density or energy took non-physical values. </dd></dl>

</div>
</div>
<a id="aead68fb45757da48ef0bc6c413160712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead68fb45757da48ef0bc6c413160712">&#9670;&nbsp;</a></span>Flux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Flux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to a state structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<p>Compute the component of the flux tensor normal to the direction of integration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to a state structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to a state structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<p>Compute the component of the flux tensor normal to the direction of integration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to a state structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>

</div>
</div>
<a id="ac8f838c5e3b0233613182a79f9e8eedb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8f838c5e3b0233613182a79f9e8eedb">&#9670;&nbsp;</a></span>HLL_Speed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HLL_Speed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>stateL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>stateR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute leftmost (SL) and rightmost (SR) speeds for the Riemann fan.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stateL</td><td>pointer to a state structure for the left state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateR</td><td>pointer to a state structure for the right state </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SL</td><td>the (estimated) leftmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SR</td><td>the (estimated) rightmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Switches:</p>
<p>ROE_ESTIMATE (YES/NO), DAVIS_ESTIMATE (YES/NO). TVD_ESTIMATE (YES/NO) JAN_HLL (YES/NO)</p>
<p>These switches set how the wave speed estimates are going to be computed. Only one can be set to 'YES', and the rest of them must be set to 'NO'</p>
<p>ROE_ESTIMATE: b_m = (0, (u_R - c_R, u_L - c_L, u_{roe} - c_{roe})) b_m = (0, (u_R + c_R, u_L + c_L, u_{roe} + c_{roe}))</p>
<p>where u_{roe} and c_{roe} are computed using Roe averages.</p>
<p>DAVIS_ESTIMATE: b_m = (0, (u_R - c_R, u_L - c_L)) b_m = (0, (u_R + c_R, u_L + c_L))</p>
<p>Compute leftmost (SL) and rightmost (SR) speeds for the Riemann fan.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stateL</td><td>pointer to a state structure for the left state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateR</td><td>pointer to a state structure for the right state </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SL</td><td>the (estimated) leftmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SR</td><td>the (estimated) rightmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Switches:</p>
<p>ROE_ESTIMATE (YES/NO), DAVIS_ESTIMATE (YES/NO)</p>
<p>These switches set how the wave speed estimates are going to be computed. Only one can be set to 'YES', and the rest of them must be set to 'NO'</p>
<p>ROE_ESTIMATE: b_m = (0, (u_R - c_R, u_L - c_L, u_{roe} - c_{roe})) b_m = (0, (u_R + c_R, u_L + c_L, u_{roe} + c_{roe}))</p>
<p>where u_{roe} and c_{roe} are computed using Roe averages.</p>
<p>DAVIS_ESTIMATE: b_m = (0, (u_R - c_R, u_L - c_L)) b_m = (0, (u_R + c_R, u_L + c_L))</p>
<p>Compute leftmost (SL) and rightmost (SR) speeds for the Riemann fan.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stateL</td><td>pointer to a state structure for the left state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateR</td><td>pointer to a state structure for the right state </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SL</td><td>the (estimated) leftmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SR</td><td>the (estimated) rightmost speed of the Riemann fan </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a20e8233df5137d8d45ca2448be4dc213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20e8233df5137d8d45ca2448be4dc213">&#9670;&nbsp;</a></span>MaxSignalSpeed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MaxSignalSpeed </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the maximum and minimum characteristic velocities for the HD equations from the vector of primitive variables state-&gt;v.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the leftmost characteristic </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the rightmost characteristic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Compute the maximum and minimum characteristic velocities for the MHD equations, cmin= v - cf, cmax = v + cf</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the leftmost characteristic </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the rightmost characteristic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Return the rightmost (cmax) and leftmost (cmin) wave propagation speed in the Riemann fan</p>
<p>Compute the maximum and minimum propagation speeds for the RHD equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the leftmost characteristic </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cmin</td><td>1-D array containing the rightmost characteristic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a580a1aefbdab713f687716381afe48a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a580a1aefbdab713f687716381afe48a2">&#9670;&nbsp;</a></span>PrimEigenvectors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimEigenvectors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provide left and right eigenvectors and corresponding eigenvalues for the primitive form of the HD equations (adiabatic, pvte &amp; isothermal cases).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It is highly recommended that state-&gt;LL and state-&gt;RR be initialized to zero <em>BEFORE</em> since only non-zero entries are treated here.</dd></dl>
<p>Wave names and their order are defined as enumeration constants in mod_defs.h.</p>
<p>Advection modes associated with passive scalars are simple cases for which lambda = u (entropy mode) and l = r = (0, ... , 1, 0, ...). For this reason they are NOT defined here and must be treated seperately.</p>
<p><b>References:</b> </p><ul>
<li>"Riemann Solvers and Numerical Methods for Fluid Dynamics", <br />
 Toro, 1997 Springer-Verlag, Eq. [3.18]</li>
</ul>
<p>Provide left and right eigenvectors and corresponding eigenvalues for the PRIMITIVE form of the MHD equations (adiabatic &amp; isothermal cases).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting grid index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final grid index</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Eigenvectors <code>state-&gt;Lp</code> and <code>state-&gt;Rp</code> must be initialized to zero <em>before</em> since only non-zero entries are treated here.</dd></dl>
<p>Wave names and their order are defined as enumeration constants in mod_defs.h. Notice that, the characteristic decomposition may differ depending on the way div.B is treated.</p>
<p>Advection modes associated with passive scalars are simple cases for which lambda = u (entropy mode) and l = r = (0, ... , 1, 0, ...). For this reason they are NOT defined here and must be treated seperately.</p>
<p><b>References:</b> </p><ul>
<li>"Notes on the Eigensystem of Magnetohydrodynamics", <br />
 P.L. Roe, D.S. Balsara, SIAM Journal on Applied Mathematics, 56, 57 (1996)</li>
<li>"A solution adaptive upwind scheme for ideal MHD", <br />
 K. G. Powell, P. L. Roe, and T. J. Linde, Journal of Computational Physics, 154, 284-309, (1999).</li>
<li>"A second-order unsplit Godunov scheme for cell-centered MHD:
      the CTU-GLM scheme"<br />
 Mignone &amp; Tzeferacos, JCP (2010) 229, 2117</li>
<li>"ATHENA: A new code for astrophysical MHD", J. Stone, T. Gardiner, ApJS, 178, 137 (2008)</li>
</ul>
<p>The derivation of the isothermal eigenvectors follows the consideration given in roe.c</p>
<p>Provide eigenvectors eigenvalues of the relativistic equations in primitive form.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state</td><td>Pointer to <a class="el" href="struct_state.html">State</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting grid index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final grid index</td></tr>
  </table>
  </dd>
</dl>
<p>Only non-zero components of LL and RR are computed; RR and LL must be initialized to zero outside. </p>

</div>
</div>
<a id="adf5a372097d87ad21cf5f967aad72d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf5a372097d87ad21cf5f967aad72d6f">&#9670;&nbsp;</a></span>PrimRHS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimRHS </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cs2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Adw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the matrix-vector multiplication <img class="formulaInl" alt="$ A(\mathbf{v})\cdot d\mathbf{v} $" src="form_170.png"/> where A is the matrix of the quasi-linear form of the MHD equations.</p>
<p><b>References</b> </p>
<ul>
<li>"A solution adaptive upwind scheme for ideal MHD", Powell et al., JCP (1999) 154, 284</li>
<li>"An unsplit Godunov method for ideal MHD via constrained transport" Gardiner &amp; Stone, JCP (2005) 205, 509</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>vector of primitive variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dv</td><td>limited (linear) slopes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cs2</td><td>local sound speed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>local enthalpy </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">AdV</td><td>matrix-vector product</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value.</dd></dl>
<p>Compute the matrix-vector multiplication <img class="formulaInl" alt="$ A(\mathbf{v})\cdot \Delta\mathbf{v} $" src="form_255.png"/> where <code>A</code> is the matrix of the quasi-linear form of the RHD equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>vector of primitive variables; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dw</td><td>limited (linear) slopes; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cs2</td><td>local sound speed; </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>local enthalpy; </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Adw</td><td>matrix-vector product.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>This function has no return value. </dd></dl>

</div>
</div>
<a id="a86a8a63023b9c5df69e30846bd2576fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86a8a63023b9c5df69e30846bd2576fb">&#9670;&nbsp;</a></span>PrimSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute source terms of the MHD equations in primitive variables. These include:</p>
<ul>
<li>Geometrical sources;</li>
<li>Shearing-box terms</li>
<li>Gravity;</li>
<li>terms related to divergence of B control (Powell eight wave and GLM);</li>
<li>FARGO source terms.</li>
</ul>
<p>The rationale for choosing during which sweep a particular source term has to be incorporated should match the same criterion used during the conservative update. For instance, in polar or cylindrical coordinates, curvilinear source terms are included during the radial sweep only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gas</td><td>pointer to a <a class="el" href="struct_sweep.html">Sweep</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">src</td><td>array of source terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to a <a class="el" href="struct_grid.html">Grid</a> structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does not work in spherical coordinates yet. For future implementations we annotate hereafter the induction equation in spherical coordinates:</dd></dl>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_tB_r + \frac{1}{r}\partial_\theta E_\phi - \frac{1}{r\sin\theta}\partial_\phi E_\theta = -E_\phi\cot\theta/r \]" src="form_171.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_t B_\theta + \frac{1}{r\sin\theta}\partial_\phi E_r - \partial_rE_\phi = E_\phi/r \]" src="form_172.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_t B_\phi + \partial_r E_\theta - \frac{1}{r}\partial_\theta E_r = - E_\theta/r\]" src="form_173.png"/>
</p>
<p>where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E_\phi = -(v \times B)_\phi = - (v_r B_\theta - v_\theta B_r) \,,\qquad E_\theta = -(v \times B)_\theta = - (v_\phi B_r - v_r B_\phi) \]" src="form_174.png"/>
</p>
<p>Compute source terms of the RHD equations in primitive variables.</p>
<ul>
<li>Geometrical sources;</li>
<li>Gravity;</li>
</ul>
<p>The rationale for choosing during which sweep a particular source term has to be incorporated should match the same criterion used during the conservative update. For instance, in polar or cylindrical coordinates, curvilinear source terms are included during the radial sweep only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>pointer to a <a class="el" href="struct_sweep.html">Sweep</a> structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">src</td><td>array of source terms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>initial index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to a <a class="el" href="struct_grid.html">Grid</a> structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a95dfdfc31eef9d5068aa8fa2f9608676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95dfdfc31eef9d5068aa8fa2f9608676">&#9670;&nbsp;</a></span>PrimToCons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrimToCons </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>uprim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>ucons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ibeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert primitive variables to conservative variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uprim</td><td>array of primitive variables </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ucons</td><td>array of conservative variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Convert primitive variables in conservative variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">uprim</td><td>array of primitive variables </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ucons</td><td>array of conservative variables </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beg</td><td>starting index of computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end</td><td>final index of computation</td></tr>
  </table>
  </dd>
</dl>
<p>Convert a vector of primitive quantities to conservative </p>

</div>
</div>
<a id="a1550e21bb1d5f31c99ab701dc8712f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1550e21bb1d5f31c99ab701dc8712f1f">&#9670;&nbsp;</a></span>RHD_EnergySolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RHD_EnergySolve </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">u</td><td>array of conservative variables (entropy will be redefined) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v</td><td>array of primitive variables</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error codes:<ul>
<li>0 = success</li>
<li>1 = solution does not exist</li>
<li>2 = negative pressure</li>
<li>3 = inaccurate solution (debug only)</li>
<li>4 = NaN </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a307e77dabc3c327f34e5c37923ee7e1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a307e77dabc3c327f34e5c37923ee7e1d">&#9670;&nbsp;</a></span>RHD_EntropySolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RHD_EntropySolve </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert the conservative variables {D, m, sigma_c} (where sigma_c = D*sigma is the conserved entropy) to primitive variable using a Newton-Raphson/Bisection scheme. </p>

</div>
</div>
<a id="ad33c3f435bed91b71be86da30e6c76c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad33c3f435bed91b71be86da30e6c76c6">&#9670;&nbsp;</a></span>RHD_PressureFix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RHD_PressureFix </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>uc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>Error codes are:<ul>
<li>0 = success</li>
<li>1 = v^2 &gt; 1</li>
<li>2 = too many iterations </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ae7521e6b8ac6465f96b8db24045cd7a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7521e6b8ac6465f96b8db24045cd7a3">&#9670;&nbsp;</a></span>VelocityLimiter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VelocityLimiter </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the total reconstructed velocity is &gt; 1 If a superluminal value occurs, flatten distribution. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 26 2021 13:23:57 for PLUTO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
